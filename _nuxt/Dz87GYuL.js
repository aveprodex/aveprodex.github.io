import{f as e,h as a,a8 as l,av as s,au as t,aK as o,aL as n,at as i,c as u,o as r,F as d,b as c,I as v,D as m,W as p,K as b,P as g,n as y,j as f,b3 as w,w as x,d as k,J as h,t as B,aM as _,aN as T,T as V,a as S,E as A,aO as F,B as N,aP as q,aQ as z,aR as I,aS as L,aT as E,aU as $,aV as C,z as M,aW as R}from"./C1fvdsSF.js";const U={key:0,class:"ml-5px"},W={class:"text-20px"},O={class:"min-h-60px py-10px"},P={class:"text-16px"},j={class:"flex mt-10px"},D=e({__name:"quickSwap",props:{quickBuyValue:{},row:{},appendTo:{default:"#__nuxt"},buttonBg:{default:"rgba(18, 184, 134, 0.15)"},mainNameVisible:{type:Boolean},classNames:{default:""},size:{default:"medium"}},emits:["submitSwap"],setup(e,{emit:D}){const{t:K}=a(),Q=e,G=l(),J=s(!1),H=s(!1),X=s(""),Y=t("noReminderQuickBuy",!1),Z=D;function ee(){var e;if(Z("submitSwap"),!F())return;if(J.value)return;if(new N(Q.quickBuyValue||0).lte(0))return void q({title:"Error",type:"error",message:K("amountMustG0")});const{row:a}=Q;X.value=K("quickBuyMsg",{a:Q.quickBuyValue,m:(null==(e=_(Q.row.chain))?void 0:e.main_name)||"",s:a.symbol||(a.target_token==a.token0_address?a.token0_symbol:a.token1_symbol)}),Y.value?se():H.value=!0}const ae=s(),le=o();async function se(){var e;H.value=!1;const{chain:a}=Q.row;J.value=!0,await async function(e){var a;const l=G.getWalletAddress(e);if(!l)return;const s=await R({chain:e,tokens:[L(e)],walletAddress:l}),t=(null==s?void 0:s[0])||{};ae.value={...t,symbol:null==(a=_(e))?void 0:a.main_name,chain:e,address:t.token||t.address,decimals:t.decimals||t.decimal}}(a);const l=ae.value,s=null==(e=new N(Q.quickBuyValue||0).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${(null==l?void 0:l.decimals)||18}})?`)))?void 0:e[0];return(Number(s)||0)<=0?(q({title:"Error",type:"error",message:K("amountTooSmall")}),void(J.value=!1)):new N(s||0).gt((null==l?void 0:l.balance)||0)?(q({title:"Error",type:"error",message:K("insufficientBalance")}),void(J.value=!1)):void async function(e){var a,l,s;const{chain:t}=Q.row,o="solana"===t,{botSettings:n}=le,i=null==(a=null==n?void 0:n[t])?void 0:a.selected,u=null==(l=null==n?void 0:n[t])?void 0:l[i];if(o&&(null==u?void 0:u.mev)&&!(await G.getBundleAvailable()))return void(J.value=!1);const{gasTip1List:r,gasTip2List:d}=z(I().gasTip,"solana"),c=(null==u?void 0:u.mev)?r:d,v=(null==u?void 0:u.mev)?null==u?void 0:u.gas[0]:null==(s=null==u?void 0:u.gas)?void 0:s[1];let m={};if(o){let e=(null==v?void 0:v.customFee)||(null==c?void 0:c[null==v?void 0:v.level])||"0.002";(null==u?void 0:u.mev)&&new N(e).lt("0.002")&&(e="0.002"),m.priorityFee=new N(e).times(10**9).toFixed(0)}else{const e=0===Number(null==v?void 0:v.customFee)?"0":(null==v?void 0:v.customFee)||(null==c?void 0:c[null==v?void 0:v.level])||"3";m.gasTip=Number(new N(e).times(10**9).toFixed(0)),m.contractType=0,m.chain=t}const p=L(t),b=(null==u?void 0:u.slippage)||"9",g=G.getWalletAddress(t);if(!g)return;m={...m,batchId:Date.now().toString(),swapList:[{creatorAddress:g,inAmount:new N(e||0).times(10**ae.value.decimals||0).toFixed(0)}],inTokenAddress:p,outTokenAddress:Q.row.token||Q.row.target_token,swapType:1,isPrivate:(null==u?void 0:u.mev)||!1,slippage:"auto"!==b?Number(new N(b).times(100).toFixed(0)):900,autoSell:(null==u?void 0:u.autoSell)||!1};(o?E(m):$(m)).then((e=>function(e,a){if(e){let e=setTimeout((()=>{q({type:"success",message:K("transactionsSubmitted")}),te.placeOrderUpdate++,J.value=!1}),500);const l=M((()=>oe.wsResult.tgbot),(s=>{var t,o,n,i;s.batchId===a&&(e&&(clearTimeout(e),e=null),te.placeOrderSuccess++,(null==(o=null==(t=null==s?void 0:s.txList)?void 0:t[0])?void 0:o.success)?(q({type:"success",message:K("tradeSuccess")}),l()):(C((null==(i=null==(n=null==s?void 0:s.txList)?void 0:n[0])?void 0:i.failMessage)||"swap error"),l()),J.value=!1)}))}}(e,m.batchId))).catch((e=>{C(e||"swap error"),J.value=!1}))}(s)}const te=n(),oe=i();return(e,a)=>{const l=h,s=p,t=A,o=T;return r(),u(d,null,[c(s,{disabled:!Number(e.quickBuyValue),loading:f(J),color:e.buttonBg,class:y(["flex items-center [&&]:px-12px",e.classNames]),style:g([{"--el-button-hover-bg-color":"rgba(18, 184, 134, 0.3)","--el-color-black":"#12B886","--el-button-border-color":"transparent","--el-button-hover-border-color":"transparent","--el-button-disabled-text-color":"#12B886","--el-button-disabled-border-color":"transparent","--el-button-disabled-bg-color":"#12B8861A"},{"font-size":f(w)(e.size).text}]),onClick:b(ee,["stop","prevent"])},{default:x((()=>{var a;return[c(l,{style:g({"font-size":f(w)(e.size).flash}),class:"mr-4px",name:"mynaui:lightning-solid"},null,8,["style"]),k(" "+B(e.quickBuyValue||0)+" ",1),e.mainNameVisible?(r(),u("span",U,B((null==(a=("getChainInfo"in e?e.getChainInfo:f(_))(e.row.chain))?void 0:a.main_name)||""),1)):m("",!0)]})),_:1},8,["disabled","loading","color","class","style"]),f(H)?(r(),v(o,{key:0,modelValue:f(H),"onUpdate:modelValue":a[1]||(a[1]=e=>V(H)?H.value=e:null),title:e.$t("buy"),width:"400px","append-to":e.appendTo},{header:x((()=>[S("span",W,B(e.$t("buy")),1)])),footer:x((()=>[c(s,{type:"primary",class:"w-full",size:"large",onClick:b(se,["stop"])},{default:x((()=>[k(B(e.$t("confirm1")),1)])),_:1})])),default:x((()=>[S("div",O,[S("div",P,B(f(X)),1),S("div",j,[c(t,{modelValue:f(Y),"onUpdate:modelValue":a[0]||(a[0]=e=>V(Y)?Y.value=e:null),class:"[&&]:[--el-checkbox-text-color:--d-999-l-666]",label:e.$t("noAlert"),size:"large"},null,8,["modelValue","label"])])])])),_:1},8,["modelValue","title","append-to"])):m("",!0)],64)}}});export{D as _};
